ModuloFinanzas As screen:
    LoadingSpinner: =LoadingSpinner.Data
    OnVisible: |-
        =/*
        If(
            !_VarModKPI;
            /*Mostrar Spinner Cargando
            Set(_VarMostrarCargando;true);;
        
            UpdateContext({_VarVerProductoProyecto:true});;
            //UpdateContext({_VarVerDependencia:false});;
            UpdateContext({_VarVerKpi:false});;
            UpdateContext({_VarVerFinanciamiento:false});;
            UpdateContext({_VarMostrarCuadroBloqueo:false});;
            Reset(Cmb_FiltroNombre_3);;
            Reset(Dpd_FiltroProyeProd_3);;
            Reset(Cmb_FiltroJefePO_3);;
            Reset(Dpd_FiltroEstado_3);;
            
            /*Mostrar Spinner Cargando
            Set(_VarMostrarCargando;false)
        )
        */

    Rectangle2_1 As rectangle:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =784
        Visible: =_VarVerPopUpPortafolio
        Width: =1920
        Y: =266
        ZIndex: =4

    GL_ProductoProyecto_3 As gallery.variableTemplateHeightGallery:
        BorderColor: =RGBA(128, 128, 128, 1)
        BorderStyle: =BorderStyle.Dotted
        BorderThickness: =1
        DelayItemLoading: =true
        Height: =782
        Items: =Filter(Col_DominiosGestion, IDProducto = Var_IDProducto)
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplateSize: =782
        Width: =1914
        X: =3
        Y: =266
        ZIndex: =5

        Label11_6 As label:
            Color: =_VarColoresApp.AzulparaCabeceras
            FontWeight: =FontWeight.Semibold
            Height: =60
            OnSelect: =Select(Parent)
            Size: =20
            Text: ="Gestión de Financiamiento "  & "- " & ThisItem.'Nombre Producto/Proyecto'
            Width: =1700
            X: =170
            Y: =10
            ZIndex: =1

        Gl_FinanciamientoProducto_1 As gallery.variableTemplateHeightGallery:
            BorderColor: =RGBA(179, 179, 179, 1)
            BorderStyle: =BorderStyle.Dotted
            BorderThickness: =2
            DelayItemLoading: =true
            Height: =495
            Items: =Sort(Col_FinanciamientoProducto,'Fecha Termino Estimada',SortOrder.Descending)
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplateSize: =120
            Width: =1802
            X: =108
            Y: =140
            ZIndex: =2

            Txt_NumeroOI_1 As text:
                BorderColor: =RGBA(128, 128, 128, 1)
                BorderThickness: =3
                Default: =ThisItem.OI
                DelayOutput: =true
                DisplayMode: |-
                    =If(
                        ThisItem.Editando,
                        DisplayMode.Edit,
                        DisplayMode.Disabled
                    )
                Height: =50
                HintText: ="N° - 200000XXXX"
                PaddingLeft: =10
                RadiusBottomLeft: =25
                RadiusBottomRight: =25
                RadiusTopLeft: =25
                RadiusTopRight: =25
                Tooltip: =
                Width: =205
                X: =188
                Y: =52
                ZIndex: =1

            Label6_76 As label:
                FontWeight: =FontWeight.Semibold
                OnSelect: =Select(Parent)
                Text: |-
                    ="Número OI:"
                Width: =190
                X: =205
                Y: =12
                ZIndex: =2

            Txt_NumeroOE_1 As text:
                BorderColor: =RGBA(128, 128, 128, 1)
                BorderThickness: =3
                Default: =ThisItem.OE
                DelayOutput: =true
                DisplayMode: |-
                    =If(
                        ThisItem.Editando,
                        DisplayMode.Edit,
                        DisplayMode.Disabled
                    )
                Height: =50
                HintText: ="N° - 10000000XXXX"
                PaddingLeft: =10
                RadiusBottomLeft: =25
                RadiusBottomRight: =25
                RadiusTopLeft: =25
                RadiusTopRight: =25
                Tooltip: =
                Width: =205
                X: =403
                Y: =52
                ZIndex: =3

            Label6_77 As label:
                FontWeight: =FontWeight.Semibold
                OnSelect: =Select(Parent)
                Text: |-
                    ="Número OE:"
                Width: =122
                X: =420
                Y: =12
                ZIndex: =4

            Txt_FondoForm1_85 As text:
                BorderColor: =RGBA(128, 128, 128, 1)
                BorderThickness: =3
                Default: =""
                DisabledBorderColor: =RGBA(128, 128, 128, 1)
                DisabledColor: =RGBA(128, 128, 128, 1)
                DisabledFill: |-
                    =If(
                        ThisItem.Editando,
                        RGBA(255, 255, 255, 1),
                        RGBA(244, 244, 244, 1)
                    )
                DisplayMode: =DisplayMode.Disabled
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                RadiusBottomLeft: =25
                RadiusBottomRight: =25
                RadiusTopLeft: =25
                RadiusTopRight: =25
                Width: =165
                X: =15
                Y: =52
                ZIndex: =5

            Dpd_EstadoFinanciamiento_1 As dropdown:
                BorderColor: =Parent.BorderColor
                BorderStyle: =BorderStyle.None
                ChevronBackground: =RGBA(255, 255, 255, 1)
                ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                ChevronDisabledFill: =RGBA(255, 255, 255, 1)
                ChevronFill: =RGBA(0, 121, 187, 1)
                ChevronHoverBackground: =RGBA(0, 121, 187, 1)
                Default: =ThisItem.'Estado OI/OE'.Value
                DisplayMode: |-
                    =If(
                        ThisItem.Editando,
                        DisplayMode.Edit,
                        DisplayMode.Disabled
                    )
                Height: =Txt_FondoForm1_85.Height -10
                HoverBorderColor: =RGBA(0, 121, 187, 1)
                Items: =["Abierta", "En proceso de cierre" ,"Cerrada"]
                PressedFill: =RGBA(0, 121, 187, 1)
                Tooltip: =ThisItem.'Estado OI/OE'.Value
                Width: =Txt_FondoForm1_85.Width -27
                X: =32
                Y: =57
                ZIndex: =6

            Label6_75 As label:
                FontWeight: =FontWeight.Semibold
                OnSelect: =Select(Parent)
                Text: |-
                    ="Estado:"
                Width: =287
                X: =32
                Y: =12
                ZIndex: =7

            Label6_78 As label:
                FontWeight: =FontWeight.Semibold
                OnSelect: =Select(Parent)
                Text: |-
                    ="Fecha Inicio:"
                Width: =287
                X: =627
                Y: =12
                ZIndex: =8

            Txt_FondoForm1_86 As text:
                BorderColor: =RGBA(128, 128, 128, 1)
                BorderThickness: =3
                Default: =""
                DisabledFill: |
                    =If(
                        !ThisItem.Editando,
                        RGBA(244, 244, 244, 1),
                        RGBA(255, 255, 255, 1)
                    )
                DisplayMode: =DisplayMode.Disabled
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                RadiusBottomLeft: =25
                RadiusBottomRight: =25
                RadiusTopLeft: =25
                RadiusTopRight: =25
                Width: =314
                X: =618
                Y: =52
                ZIndex: =9

            Dtp_FechaInicioFinanciamiento_1 As datepicker:
                BorderColor: =
                BorderStyle: =BorderStyle.None
                BorderThickness: =0
                DefaultDate: =ThisItem.'Fecha Inicio de desarrollo'
                DisplayMode: |-
                    =If(
                        ThisItem.Editando,
                        DisplayMode.Edit,
                        DisplayMode.Disabled
                    )
                EndYear: =Year(Today())+100
                Height: =Txt_FondoForm1_86.Height - 10
                IconBackground: =Color.White
                IconFill: =RGBA(0, 121, 187, 1)
                IsEditable: =true
                PaddingBottom: =0
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                StartYear: =1899
                Tooltip: =
                Width: =Txt_FondoForm1_86.Width - 27
                X: =635
                Y: =57
                ZIndex: =10

            Label6_79 As label:
                FontWeight: =FontWeight.Semibold
                OnSelect: =Select(Parent)
                Text: |-
                    ="Fecha Fin:"
                Width: =287
                X: =949
                Y: =12
                ZIndex: =11

            Txt_FondoForm1_87 As text:
                BorderColor: =RGBA(128, 128, 128, 1)
                BorderThickness: =3
                Default: =""
                DisabledFill: |-
                    =If(
                        !ThisItem.Editando,
                        RGBA(244, 244, 244, 1),
                        RGBA(255, 255, 255, 1)
                    )
                DisplayMode: =DisplayMode.Disabled
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                RadiusBottomLeft: =25
                RadiusBottomRight: =25
                RadiusTopLeft: =25
                RadiusTopRight: =25
                Width: =314
                X: =940
                Y: =52
                ZIndex: =12

            Dtp_FechaFinFinanciamiento_1 As datepicker:
                BorderColor: =
                BorderStyle: =BorderStyle.None
                BorderThickness: =0
                DefaultDate: =ThisItem.'Fecha Termino Estimada'
                DisplayMode: |-
                    =If(
                        ThisItem.Editando,
                        DisplayMode.Edit,
                        DisplayMode.Disabled
                    )
                EndYear: =Year(Today())+100
                Height: =Txt_FondoForm1_87.Height - 10
                IconBackground: =Color.White
                IconFill: =RGBA(0, 121, 187, 1)
                IsEditable: =true
                PaddingBottom: =0
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                StartYear: =1899
                Tooltip: =
                Width: =Txt_FondoForm1_87.Width - 27
                X: =957
                Y: =57
                ZIndex: =13

            Txt_ComentarioFinanciamiento_1 As text:
                BorderColor: =RGBA(128, 128, 128, 1)
                BorderThickness: =3
                Default: =ThisItem.Descripción
                DelayOutput: =true
                DisplayMode: |-
                    =If(
                        ThisItem.Editando,
                        DisplayMode.Edit,
                        DisplayMode.Disabled
                    )
                Height: =50
                Mode: =TextMode.MultiLine
                PaddingTop: =8
                RadiusBottomLeft: =25
                RadiusBottomRight: =25
                RadiusTopLeft: =25
                RadiusTopRight: =25
                Tooltip: =
                Width: =430
                X: =1262
                Y: =52
                ZIndex: =14

            Label6_80 As label:
                FontWeight: =FontWeight.Semibold
                OnSelect: =Select(Parent)
                Text: |-
                    ="Comentario:" 
                Width: =190
                X: =1279
                Y: =12
                ZIndex: =15

            Icon9_2 As icon.Edit:
                Color: |
                    =If(
                        ThisItem.Editando,
                        Color.Green,
                        RGBA(39, 67, 125, 1)
                    )
                DisabledColor: =RGBA(128, 128, 128, 1)
                DisplayMode: |-
                    =If(
                        ThisItem.'Estado OI/OE'.Value = "Cerrada" || IsBlank(Dtp_FechaInicioFinanciamiento_1.SelectedDate) || IsBlank(Dtp_FechaFinFinanciamiento_1.SelectedDate),
                        DisplayMode.Disabled,
                        If(
                            ThisItem.Editando,
                            If(
                                IsBlank(Txt_NumeroOI_1.Text) && IsBlank(Txt_NumeroOE_1.Text),
                                DisplayMode.Disabled,
                                If(
                                    !IsBlank(Txt_NumeroOI_1.Text) && IsBlank(Txt_NumeroOE_1.Text) && IsMatch(Txt_NumeroOI_1.Text, "(?!^0*$)(?!^0*\.0*$)^\d{10}?$") && Left(Txt_NumeroOI_1.Text,1) = "2",
                                    DisplayMode.Edit,
                                    If(
                                        IsBlank(Txt_NumeroOI_1.Text) && !IsBlank(Txt_NumeroOE_1.Text) && IsMatch(Txt_NumeroOE_1.Text, "(?!^0*$)(?!^0*\.0*$)^\d{12}?$") && Left(Txt_NumeroOE_1.Text,1) = "1",
                                        DisplayMode.Edit,
                                        If(
                                            !IsBlank(Txt_NumeroOI_1.Text) && !IsBlank(Txt_NumeroOE_1.Text) && 
                                            IsMatch(Txt_NumeroOI_1.Text, "(?!^0*$)(?!^0*\.0*$)^\d{10}?$") && Left(Txt_NumeroOI_1.Text,1) = "2" &&
                                            IsMatch(Txt_NumeroOE_1.Text, "(?!^0*$)(?!^0*\.0*$)^\d{12}?$") && Left(Txt_NumeroOE_1.Text,1) = "1",
                                            DisplayMode.Edit,
                                            DisplayMode.Disabled
                                        )
                                    )
                                )
                            ),
                            DisplayMode.Edit
                        )
                    )
                Height: =50
                Icon: |-
                    =If(
                        ThisItem.Editando,
                        Icon.CheckBadge,
                        Icon.Edit
                    )
                OnSelect: |-
                    =If(
                        IsBlank(Txt_NumeroOI_1.Text) &&  IsBlank(Txt_NumeroOE_1.Text) && ThisItem.Editando, 
                        Notify("No puedes cerrar la orden de financiamiento si tienes el campo OI/OE en blanco",NotificationType.Warning,5000),
                        /*Mostrar Spinner Cargando*/
                        Set(_VarMostrarCargando,true);
                        If(
                            ThisItem.Editando,
                            Patch(
                                Portafolio,
                                If(
                                    IsBlank(LookUp(Portafolio,IDProducto = ThisItem.IDProducto && ID = ThisItem.ID)),
                                    Defaults(Portafolio),
                                    LookUp(Portafolio,IDProducto = ThisItem.IDProducto && ID = ThisItem.ID )
                                ),
                                {
                                    IDProducto: ThisItem.IDProducto,
                                    OI: Txt_NumeroOI_1.Text,
                                    OE: Txt_NumeroOE_1.Text,
                                    'Estado OI/OE':Dpd_EstadoFinanciamiento_1.Selected,
                                    'Fecha Inicio de desarrollo': Dtp_FechaInicioFinanciamiento_1.SelectedDate,
                                    'Fecha Termino Estimada': Dtp_FechaFinFinanciamiento_1.SelectedDate,
                                    Descripción: Txt_ComentarioFinanciamiento_1.Text
                                    //Editando: false
                                }
                            );
                                
                            /* Gestion de Errores */
                            ClearCollect(Col_ErroresGuardarFinanciamiento, Errors(Portafolio,ThisItem));
                            If(
                                IsEmpty(Col_ErroresGuardarFinanciamiento),
                    
                                Refresh(Portafolio);
                                ClearCollect(Col_BD_Financiamiento,Portafolio);
                                
                                Patch(
                                    Col_FinanciamientoProducto,
                                    ThisItem,
                                    {
                                        IDProducto: ThisItem.IDProducto,
                                        OI: Txt_NumeroOI_1.Text,
                                        OE: Txt_NumeroOE_1.Text,
                                        'Estado OI/OE':Dpd_EstadoFinanciamiento_1.Selected,
                                        'Fecha Inicio de desarrollo': Dtp_FechaInicioFinanciamiento_1.SelectedDate,
                                        'Fecha Termino Estimada': Dtp_FechaFinFinanciamiento_1.SelectedDate,
                                        Descripción: Txt_ComentarioFinanciamiento_1.Text,
                                        Editando: false
                                    }
                                );
                                ClearCollect(Col_FinanciamientoProducto,Filter(Col_BD_Financiamiento, IDProducto = ThisItem.IDProducto));
                                Notify("Se guardo correctamente el financiamiento",NotificationType.Success,4000),
                    
                                Patch(Lst_GestionErrores,
                                Defaults(Lst_GestionErrores),
                                    {
                                        Modulo: "FINANCIAMIENTO", 
                                        Usuario: _Perfil.displayName, 
                                        FechaError: Today(), 
                                        MensajeError:First(Col_ErroresGuardarKPI).Message, 
                                        IDError: First(Col_ErroresGuardarKPI).Error, 
                                        HoraError: Hour(Now()) & ":" & Minute(Now()), 
                                        CampoError: First(Col_ErroresGuardarKPI).Column
                                    }
                                );
                                Notify(First(Col_ErroresGuardarKPI).Message,NotificationType.Error,4000)
                            ),
                            /* ------------------ */
                                Patch(Col_FinanciamientoProducto,ThisItem,{Editando: true})
                        );
                        /*Ocultar Spinner Cargando*/
                        Set(_VarMostrarCargando,false)
                    )
                Width: =37
                X: =1698
                Y: =52
                ZIndex: =16

            Icon9_3 As icon.Edit:
                Color: |-
                    =If(
                        ThisItem.Editando,
                        Color.Red,
                        Color.Black
                    )
                Height: =50
                Icon: |-
                    =Icon.CancelBadge
                    /*
                    If(
                        ThisItem.Editando;
                        Icon.CancelBadge;
                        Icon.Trash
                    )
                    */
                OnSelect: |
                    =If(
                        ThisItem.Editando,
                        Reset(Dpd_EstadoFinanciamiento_1);
                        Reset(Txt_NumeroOI_1);
                        Reset(Txt_NumeroOE_1);
                        Reset(Dtp_FechaInicioFinanciamiento_1);
                        Reset(Dtp_FechaFinFinanciamiento_1);
                        Reset(Txt_ComentarioFinanciamiento_1);
                    
                        Patch(Col_FinanciamientoProducto,ThisItem,{Editando: false})
                        //Remove(Col_FinanciamientoProducto;ThisItem);;
                        //Remove(Portafolio;ThisItem)
                    )
                Visible: =ThisItem.Editando
                Width: =37
                X: =1743
                Y: =52
                ZIndex: =17

            Icn_ValOI_1 As icon.CheckBadge:
                Color: |-
                    =If(
                        IsMatch(Txt_NumeroOI_1.Text, "(?!^0*$)(?!^0*\.0*$)^\d{10}?$") && Left(Txt_NumeroOI_1.Text,1) = "2" ,Color.Green,Color.Red)
                DisabledColor: |-
                    =If(
                        IsMatch(Txt_NumeroOI_1.Text, "(?!^0*$)(?!^0*\.0*$)^\d{10}?$") && Left(Txt_NumeroOI_1.Text,1) = "2" ,Color.Green,Color.Red)
                DisplayMode: =DisplayMode.Disabled
                Height: =25
                HoverColor: =Color.Green
                Icon: |
                    =If(IsMatch(Txt_NumeroOI_1.Text, "(?!^0*$)(?!^0*\.0*$)^\d{10}?$") && Left(Txt_NumeroOI_1.Text,1) = "2" ,Icon.CheckBadge,Icon.Cancel)
                Tooltip: |-
                    ="Ejemplo de numero de OI: 200000XXXX"
                Visible: |
                    =    If(
                            IsBlank(Txt_NumeroOI_1.Text),
                            false,
                            true
                        )
                Width: =25
                X: =319
                Y: =19
                ZIndex: =18

            Icn_ValOE_1 As icon.CheckBadge:
                Color: |-
                    =If(
                        IsMatch(Txt_NumeroOE_1.Text, "(?!^0*$)(?!^0*\.0*$)^\d{12}?$") && Left(Txt_NumeroOE_1.Text,1) = "1" ,Color.Green,Color.Red)
                DisabledColor: |-
                    =If(
                        IsMatch(Txt_NumeroOE_1.Text, "(?!^0*$)(?!^0*\.0*$)^\d{12}?$") && Left(Txt_NumeroOE_1.Text,1) = "1" ,Color.Green,Color.Red)
                DisplayMode: =DisplayMode.Disabled
                Height: =25
                HoverColor: =Color.Green
                Icon: |-
                    =If(
                        IsMatch(Txt_NumeroOE_1.Text, "(?!^0*$)(?!^0*\.0*$)^\d{12}?$") && Left(Txt_NumeroOE_1.Text,1) = "1" ,Icon.CheckBadge,Icon.Cancel)
                Tooltip: |-
                    ="Ejemplo de numero de OI: 10000000XXXX"
                Visible: |-
                    =    If(
                            IsBlank(Txt_NumeroOE_1.Text),
                            false,
                            true
                        )
                Width: =25
                X: =542
                Y: =19
                ZIndex: =19

            Icn_CampanaOF_1 As icon.Bell:
                Color: =RGBA(255, 0, 0, 1)
                Height: =32
                Icon: =Icon.Bell
                OnSelect: =Select(Parent)
                Tooltip: ="Orden de financiamiento vencida"
                Visible: |-
                    =If(
                        ThisItem.'Estado OI/OE'.Value = "Abierta",
                        If(
                            DateDiff(ThisItem.'Fecha Termino Estimada',Today(),TimeUnit.Days)>0,
                            true,
                            false
                        )
                    )
                Width: =40
                X: =1741
                ZIndex: =20

        Label10_18 As label:
            DisabledColor: =RGBA(128, 128, 128, 1)
            DisplayMode: |-
                =If(
                    CountIf(Col_FinanciamientoProducto,'Estado OI/OE'.Value = "Abierta")>0 || CountIf(Gl_FinanciamientoProducto_1.AllItems, Editando = true)>0,
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            FontWeight: =FontWeight.Bold
            Height: =28
            OnSelect: |-
                =//Set(_VarIDKPI; "KPI-" & GUID());;
                
                Patch(
                    Col_FinanciamientoProducto,
                    Defaults(Col_FinanciamientoProducto),
                    {
                        IDProducto: ThisItem.IDProducto,
                        OI: "",
                        OE: "",
                        'Estado OI/OE': {Value:"Abierta"},
                        'Fecha Inicio de desarrollo': Today(),
                        'Fecha Termino Estimada': Today(),
                        Descripción: "",
                        Creado: Now(),
                        Editando: true
                    }
                );
            Text: ="Agregar Financiamiento"
            Tooltip: ="Agregar Producto / Proyecto"
            Width: =262
            X: =145
            Y: =100
            ZIndex: =3

        Image8_6 As image:
            Height: =56
            Image: =sp06
            OnSelect: =Select(Parent)
            Width: =82
            X: =104
            Y: =11
            ZIndex: =4

        Lbl_MsjAlertaVencimiento As label:
            Align: =Align.Center
            Color: =RGBA(255, 0, 0, 1)
            FontWeight: =FontWeight.Semibold
            Height: =54
            OnSelect: =Select(Parent)
            Text: ="** Cuenta con una orden de financiamiento vencida, favor actualizar la orden."
            Visible: |-
                =If(
                    CountIf(Col_FinanciamientoProducto,'Estado OI/OE'.Value = "Abierta") > 0 && 
                    DateDiff(First(Sort(Filter(Col_FinanciamientoProducto,'Estado OI/OE'.Value = "Abierta"),'Fecha Termino Estimada',SortOrder.Ascending)).'Fecha Termino Estimada',Today(),TimeUnit.Days)>0,
                    true,
                    false
                )
            Width: =737
            X: =740
            Y: =76
            ZIndex: =5

        Image24_1 As image:
            DisplayMode: |-
                =If(
                    CountIf(Col_FinanciamientoProducto,'Estado OI/OE'.Value = "Abierta")>0 || CountIf(Gl_FinanciamientoProducto_1.AllItems, Editando = true)>0,
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            Height: =40
            Image: ='nuevo agregar '
            OnSelect: |-
                =//Set(_VarIDKPI; "KPI-" & GUID());;
                
                Patch(
                    Col_FinanciamientoProducto,
                    Defaults(Col_FinanciamientoProducto),
                    {
                        IDProducto: ThisItem.IDProducto,
                        OI: "",
                        OE: "",
                        'Estado OI/OE': {Value:"Abierta"},
                        'Fecha Inicio de desarrollo': Today(),
                        'Fecha Termino Estimada': Today(),
                        Descripción: "",
                        Creado: Now(),
                        Editando: true
                    }
                );
            Tooltip: ="Agregar nuevo financiamiento"
            Width: =40
            X: =105
            Y: =89
            ZIndex: =6

        Btn_SeleccionarLimpiarFiltro_17 As button:
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(244, 244, 244, 0.4)
            DisplayMode: |-
                =If(
                    CountIf(Col_FinanciamientoProducto,'Estado OI/OE'.Value = "Abierta")>0 || CountIf(Gl_FinanciamientoProducto_1.AllItems, Editando = true)>0,
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            HoverFill: =RGBA(255, 255, 255, 0.5)
            OnSelect: |-
                =//Set(_VarIDKPI; "KPI-" & GUID());;
                
                Patch(
                    Col_FinanciamientoProducto,
                    Defaults(Col_FinanciamientoProducto),
                    {
                        IDProducto: ThisItem.IDProducto,
                        OI: "",
                        OE: "",
                        'Estado OI/OE': {Value:"Abierta"},
                        'Fecha Inicio de desarrollo': Today(),
                        'Fecha Termino Estimada': Today(),
                        Descripción: "",
                        Creado: Now(),
                        Editando: true
                    }
                );
            PressedFill: =RGBA(255, 255, 255, 0.7)
            Text: =""
            Tooltip: =If( Self.DisplayMode = DisplayMode.Disabled, "Para poder agregar una nueva orden de financiamiento, debe cerrar la que esta abierta.","Agregar nueva orden de financiamiento")
            Width: =260
            X: =104
            Y: =83
            ZIndex: =7

        Icn_Abrir_Cerrar_Registro_4 As icon.ChevronDown:
            Height: =42
            Icon: =Icon.ChevronUp
            OnSelect: |-
                = /*Mostrar Spinner Cargando*/
                Set(_VarMostrarCargando,true);
                
                Set(_VarVerPopUpPortafolio,false);
                Navigate(ListadoProductoProyecto,Transition.None);
                 
                /*Mostrar Spinner Cargando*/
                Set(_VarMostrarCargando,false)
            Width: =44
            X: =23
            Y: =18
            ZIndex: =14

        Rectangle3_4 As rectangle:
            Fill: =RGBA(230, 230, 230, 1)
            Height: =350
            Width: =2
            X: =80
            Y: =72
            ZIndex: =15

        Gp_Menu_3 As group:
            Height: =5
            Width: =5
            X: =-6
            Y: =-18
            ZIndex: =15

            Img_Finanza_3 As image:
                Height: =50
                Image: =Icn_finanzas01
                OnSelect: =Select(Parent)
                Width: =50
                X: =11
                Y: =303
                ZIndex: =8

            Img_KPI_3 As image:
                Height: =50
                Image: =Icn_kpi2
                OnSelect: =Select(Parent)
                Width: =50
                X: =11
                Y: =221
                ZIndex: =9

            Img_Portafolio_3 As image:
                Height: =50
                Image: ='Icn_gestionar 01'
                OnSelect: =Select(Parent)
                Width: =50
                X: =11
                Y: =132
                ZIndex: =10

            Btn_KPIs_3 As button:
                DisabledBorderColor: =RGBA(255, 255, 255, 1)
                DisabledFill: =RGBA(255, 255, 255, 1)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =60
                HoverColor: =RGBA(255, 255, 0, 0.13)
                HoverFill: =RGBA(255, 255, 0, 0.13)
                OnSelect: |-
                    =/*
                    UpdateContext({_VarVerProductoProyecto:false});;
                    //UpdateContext({_VarVerDependencia:false});;
                    UpdateContext({_VarVerKpi:true});;
                    //UpdateContext({_VarVerDetalleKPI:false});;
                    UpdateContext({_VarVerFinanciamiento:false});; 
                    UpdateContext({_VarVerDBloqueoI:false});;
                    ClearCollect(Col_KPIProducto;Sort(Filter(Col_BD_KPIs; IDProducto = ThisItem.IDProducto);Creado;SortOrder.Descending));;
                    Clear(Col_RegistrosPorKPI);;
                    */
                    
                    
                    //Set(Var_IDProducto;ThisItem.IDProducto);;
                    Navigate(ModuloKPI,ScreenTransition.None)
                PressedColor: =RGBA(255, 255, 255, 1)
                Size: =25
                Text: =""
                Tooltip: ="Gestionar KPIs"
                Width: =60
                X: =6
                Y: =214
                ZIndex: =11

            Btn_Financiamiento_3 As button:
                DisabledBorderColor: =RGBA(255, 255, 255, 1)
                DisabledFill: =RGBA(255, 255, 255, 1)
                DisplayMode: |+
                    =If(
                        ThisItem.'Nombre Producto/Proyecto' = "NUEVO PRODUCTO / PROYECTO" && ThisItem.Editando,
                        DisplayMode.Disabled,
                        If(
                            ThisItem.Editando && ThisItem.RequiereFinanciamiento = "NO",
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    )
                    
                Fill: =RGBA(153, 207, 236, 0.24)
                Height: =60
                HoverFill: =RGBA(153, 207, 236, 0.24)
                OnSelect: |-
                    =/*
                    UpdateContext({_VarVerProductoProyecto:false});;
                    //UpdateContext({_VarVerDependencia:false});;
                    UpdateContext({_VarVerKpi:false});;
                    //UpdateContext({_VarVerDetalleKPI:false});;
                    UpdateContext({_VarVerFinanciamiento:true});;
                    ClearCollect(Col_FinanciamientoProducto;Filter(Col_BD_Financiamiento; IDProducto = ThisItem.IDProducto))
                    */
                PressedColor: =RGBA(153, 207, 236, 0.24)
                Size: =25
                Text: =""
                Tooltip: ="Gestionar Financiamiento"
                Width: =60
                X: =6
                Y: =298
                ZIndex: =12

            Btn_Portafolio_3 As button:
                DisabledBorderColor: =RGBA(255, 255, 255, 1)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =60
                HoverColor: =RGBA(222, 154, 237, 0.22)
                HoverFill: =
                OnSelect: |-
                    =//Set(_VarModulos;true);;
                    
                    If(
                        Gestionando = "Proyecto",
                        Navigate(ModuloProyectos,ScreenTransition.Fade),
                        Navigate(ListadoProductoProyecto,ScreenTransition.Fade);
                        Set(_VarVerPopUpPortafolio,true)
                    )
                    
                    /*
                    UpdateContext({_VarVerProductoProyecto:true});;
                    //UpdateContext({_VarVerDependencia:false});;
                    UpdateContext({_VarVerKpi:false});;
                    //UpdateContext({_VarVerDetalleKPI:false});;
                    UpdateContext({_VarVerFinanciamiento:false});;
                    */
                PressedFill: =RGBA(222, 154, 237, 0.22)
                Size: =25
                Text: =""
                Tooltip: ="Gestionar Producto / Proyecto"
                Width: =60
                X: =6
                Y: =126
                ZIndex: =13

        Rct_Separador_4 As rectangle:
            Fill: =RGBA(179, 179, 179, 1)
            Height: =1
            OnSelect: =Select(Parent)
            Width: =1750
            X: =120
            Y: =72
            ZIndex: =16

    HtmlText2 As htmlViewer:
        Height: =131
        HtmlText: |-
            ="<table style='height: 108px; width: 100%; border-collapse: collapse; border-style: none; margin-left: 5px;' border='0'>
            <tbody style='padding-left: 5px;'>
            <tr style='height: 18px; padding-left: 40px;'>
            <td style='width: 25.3934%; height: 18px; text-align: left; padding-left: 5px;' colspan='2'><strong>Leyenda de los estados</strong></td>
            </tr>
            <tr style='height: 36px;'>
            <td style='width: 25.3934%; height: 36px; text-align: left; padding-left: 5px;'>Abierta</td>
            <td style='width: 74.6066%; text-align: justify; height: 36px; padding-left: 5px;'>Las &oacute;rdenes est&aacute;n disponibles para financiar el desarrollo de un producto/proyecto.</td>
            </tr>
            <tr style='height: 18px;'>
            <td style='width: 25.3934%; height: 18px; text-align: left; padding-left: 5px;'>En proceso de cierre</td>
            <td style='width: 74.6066%; text-align: justify; height: 18px; padding-left: 5px;'>Se informó a Control de Gestión del cierre de la orden.</td>
            </tr>
            <tr style='height: 36px;'>
            <td style='width: 25.3934%; height: 36px; text-align: left; padding-left: 5px;'>Cerrada</td>
            <td style='width: 74.6066%; text-align: justify; height: 36px; padding-left: 5px;'>Las &oacute;rdenes no est&aacute;n disponibles.</td>
            </tr>
            </tbody>
            </table>"
        Width: =826
        X: =108
        Y: =917
        ZIndex: =6

    MenuLateral_6 As MenuLateral:
        Height: =MenuLateral_6.AltoApp
        PermisoData: =PermisoUsuario.servicioData
        PermisoPersona: =PermisosPersonas
        Width: =MenuLateral_6.AnchoApp
        X: =9
        Y: =8
        ZIndex: =28

    HtmlText2_2 As htmlViewer:
        Height: =93
        HtmlText: ="<Strong>Asegúrate de que todos los pagos estén al día al momento de cerrar la orden.</Strong>"
        Size: =13
        Width: =284
        X: =1468
        Y: =935
        ZIndex: =29

    Image8_20 As image:
        Height: =74
        Image: =Captura
        OnSelect: =
        Width: =77
        X: =1386
        Y: =935
        ZIndex: =30

    Cargando_6 As Cargando:
        Visible: =_VarMostrarCargando
        ZIndex: =31

    Gp_CabeceraPortafolio_3 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =32

        Rct_FondoCabecera_Persona_5 As rectangle:
            Fill: =_VarColoresApp.AzulparaCabeceras
            Height: =60
            Width: =1920
            ZIndex: =1

        Img_UsuarioPantallaPersona_5 As image:
            Height: =50
            Image: =_UserFoto
            RadiusBottomLeft: =50
            RadiusBottomRight: =50
            RadiusTopLeft: |
                =50
            RadiusTopRight: =50
            Width: =54
            X: =1772
            Y: =5
            ZIndex: =2

        Btn_Back_3 As button:
            Fill: =_VarColoresApp.VerdeParaBotones
            Height: =60
            HoverFill: =_VarColoresApp.AzulFondo
            OnSelect: |-
                =Reset(Rd_InternoExterno);
                Reset(Cmb_BuscarMiEquipo);
                //UpdateContext({_VarMostrarEdicionEquipo:false});;
                Clear(Col_UsuarioenEquipo);
                ResetForm(Frm_EditarEquipo);
                Reset(Rd_PersonasEquipos);
                Navigate(Portada,ScreenTransition.Fade)
            PaddingTop: =2.5
            PressedFill: =_VarColoresApp.VerdeParaBotones
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =35
            Text: ="⬅"
            Tooltip: ="Regresar"
            Width: =83
            X: =1837
            ZIndex: =3

    Gp_Filtros_8 As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =55

        Html_FondoNuevoEquipo_27 As htmlViewer:
            Height: =145
            HtmlText: |-
                ="
                <div style='
                    width: 1450px;
                    height: 105px;
                    background: #C4D5E3;
                    border-radius: 20px;
                    box-shadow: 0px 0px 10px #888888;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    padding: 10px;
                '>
                </div>
                "
            PaddingLeft: =10
            Width: =1500
            X: =205
            Y: =99
            ZIndex: =7

        Txt_FondoForm1_55 As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            BorderThickness: =3
            Default: =Dpd_FiltroProyeProd.Selected.Value
            DisabledColor: =RGBA(51, 51, 51, 1)
            DisplayMode: =DisplayMode.Disabled
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            RadiusBottomLeft: =25
            RadiusBottomRight: =25
            RadiusTopLeft: =25
            RadiusTopRight: =25
            Width: =314
            X: =420
            Y: =147
            ZIndex: =8

        Label6_65 As label:
            FontWeight: =FontWeight.Semibold
            Text: |-
                ="Tipo:"
            Width: =287
            X: =426
            Y: =107
            ZIndex: =9

        Label6_71 As label:
            FontWeight: =FontWeight.Semibold
            Text: |-
                ="Nombre del proyecto:" 
            Width: =287
            X: =763
            Y: =107
            ZIndex: =10

        Txt_FondoForm1_98 As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            BorderThickness: =3
            Default: =Cmb_FiltroJefePO.Selected.DisplayName
            DisabledColor: =RGBA(77, 77, 77, 1)
            DisplayMode: =DisplayMode.Disabled
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            RadiusBottomLeft: =25
            RadiusBottomRight: =25
            RadiusTopLeft: =25
            RadiusTopRight: =25
            Width: =314
            X: =1085
            Y: =147
            ZIndex: =11

        DataCardKey15_15 As label:
            AutoHeight: =true
            Color: =RGBA(0, 0, 0, 1)
            FontWeight: =FontWeight.Semibold
            Text: |-
                ="PO / JP:"
            Width: =239
            Wrap: =false
            X: =1095
            Y: =107
            ZIndex: =12

        Txt_FondoForm1_100 As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            BorderThickness: =3
            Default: =Cmb_FiltroNombre.Selected.'Nombre Producto/Proyecto'
            DisabledColor: =RGBA(77, 77, 77, 1)
            DisplayMode: =DisplayMode.Disabled
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            RadiusBottomLeft: =25
            RadiusBottomRight: =25
            RadiusTopLeft: =25
            RadiusTopRight: =25
            Width: =314
            X: =756
            Y: =147
            ZIndex: =13

        Txt_FondoForm1_101 As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            BorderThickness: =3
            Default: =Dpd_FiltroEstado.Selected.Value
            DisabledColor: =RGBA(77, 77, 77, 1)
            DisplayMode: =DisplayMode.Disabled
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            RadiusBottomLeft: =25
            RadiusBottomRight: =25
            RadiusTopLeft: =25
            RadiusTopRight: =25
            Width: =192
            X: =1430
            Y: =147
            ZIndex: =14

        Label6_72 As label:
            FontWeight: =FontWeight.Semibold
            Text: |-
                ="Estado:"
            Width: =182
            X: =1430
            Y: =107
            ZIndex: =15

        Label10_38 As label:
            FontWeight: =FontWeight.Bold
            Height: =35
            Text: ="Filtra por"
            Width: =122
            X: =294
            Y: =112
            ZIndex: =16

        Label10_39 As label:
            DisabledColor: =RGBA(128, 128, 128, 1)
            DisplayMode: |-
                =If(
                    _VarVerPopUpPortafolio,
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            FontWeight: =FontWeight.Bold
            Text: ="Agregar"
            Tooltip: ="Agregar nuevo Producto / Proyecto"
            Width: =98
            X: =1732
            Y: =161
            ZIndex: =17

        Label13_8 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Semibold
            Height: =55
            Size: =25
            Text: ="PROYECTO TECNOLOGICO"
            Visible: |-
                =If(
                    _VarVerPopUpPortafolio,
                    false,
                    true
                )
            Width: =611
            X: =649
            Y: =2
            ZIndex: =18

        Image5_9 As image:
            Height: =35
            Image: ='filtrar (1)'
            Width: =40
            X: =245
            Y: =112
            ZIndex: =19

        Img_AgregarPrdPry_9 As image:
            DisplayMode: |-
                =If(
                    _VarVerPopUpPortafolio,
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            Height: =40
            Image: ='nuevo agregar '
            Tooltip: ="Agregar nuevo Producto / Proyecto"
            Width: =40
            X: =1694
            Y: =161
            ZIndex: =20

        Image20_9 As image:
            Height: =35
            Image: =borrarnose
            Tooltip: ="Limpiar Filtros"
            Width: =40
            X: =250
            Y: =161
            ZIndex: =21

        Label10_40 As label:
            FontWeight: =FontWeight.Bold
            Height: =38
            Text: ="Limpiar"
            Width: =122
            X: =294
            Y: =163
            ZIndex: =22

        Label10_41 As label:
            DisabledColor: =RGBA(128, 128, 128, 1)
            DisplayMode: |-
                =If(
                    _VarVerPopUpPortafolio,
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            FontWeight: =FontWeight.Bold
            OnSelect: |-
                =Concurrent(
                ClearCollect(Col_BD_Portafolio,'Dominio - Proyecto/Producto'),
                ClearCollect(Col_BD_Financiamiento,Portafolio),
                ClearCollect(Col_BD_OA,'Necesidades Walmart Tech'),
                ClearCollect(Col_BD_KPIs,'Outcome - Galería Indice Producto/Métrica'),
                ClearCollect(Col_BD_DetalleKPIs,OUTCOME)
                //ClearCollect(Col_BD_Dependencias;Lst_DependenciasPortafolio)
                );
                
                ClearCollect(Col_IDDOminios, Filter(Col_BD_Dominios, Title in Col_DominiosAsignados.Value).IDDominio);
                ClearCollect(Col_DominiosGestion, Filter(Col_BD_Portafolio, IDDominio in Col_IDDOminios.IDDominio));
                UpdateContext({_VarMostrarCuadroBloqueo:false})
            Text: ="Actualizar"
            Tooltip: ="Agregar Producto / Proyecto"
            Width: =98
            X: =1732
            Y: =112
            ZIndex: =23

        Image23_9 As image:
            Height: =40
            Image: ='nuevo actualizar '
            OnSelect: |-
                =Concurrent(
                ClearCollect(Col_BD_Portafolio,'Dominio - Proyecto/Producto'),
                ClearCollect(Col_BD_Financiamiento,Portafolio),
                ClearCollect(Col_BD_OA,'Necesidades Walmart Tech'),
                ClearCollect(Col_BD_KPIs,'Outcome - Galería Indice Producto/Métrica'),
                ClearCollect(Col_BD_DetalleKPIs,OUTCOME)
                );
                
                ClearCollect(Col_IDDOminios, Filter(Col_BD_Dominios, Title in Col_DominiosAsignados.Value).IDDominio);
                ClearCollect(Col_DominiosGestion, Filter(Col_BD_Portafolio, IDDominio in Col_IDDOminios.IDDominio));
                UpdateContext({_VarMostrarCuadroBloqueo:false})
            Tooltip: ="Actualizar datos"
            Width: =35
            X: =1694
            Y: =112
            ZIndex: =24

        Btn_Pry_LimpiarFiltros_2 As button:
            Fill: =RGBA(0, 0, 0, 0)
            Height: =43
            HoverFill: =RGBA(255, 255, 255, 0.5)
            OnSelect: =Notify("No puede usar este control en este momento, termine de editar el proyecto.",NotificationType.Information,5000)
            PressedFill: =RGBA(255, 255, 255, 0.7)
            Text: =""
            Width: =136
            X: =245
            Y: =158
            ZIndex: =25

        Btn_Pry_AgregarProyecto_2 As button:
            DisabledBorderColor: =RGBA(255, 255, 255, 1)
            DisabledFill: =RGBA(244, 244, 244, 0.4)
            DisplayMode: |-
                =If(
                    _VarVerPopUpPortafolio,
                    DisplayMode.Disabled,
                    DisplayMode.Edit
                )
            Fill: =RGBA(0, 0, 0, 0)
            Height: =43
            HoverFill: =RGBA(255, 255, 255, 0.5)
            OnSelect: =Notify("No puede usar este control en este momento, termine de editar el proyecto.",NotificationType.Information,5000)
            PressedFill: =RGBA(255, 255, 255, 0.7)
            Text: =""
            Width: =136
            X: =1692
            Y: =159
            ZIndex: =26

        Btn_Pry_ActualizarDatos_2 As button:
            Fill: =RGBA(0, 0, 0, 0)
            Height: =43
            HoverFill: =RGBA(255, 255, 255, 0.5)
            OnSelect: =Notify("No puede usar este control en este momento, termine de editar el proyecto.",NotificationType.Information,5000)
            PressedFill: =RGBA(255, 255, 255, 0.7)
            Text: =""
            Width: =136
            X: =1692
            Y: =109
            ZIndex: =27

